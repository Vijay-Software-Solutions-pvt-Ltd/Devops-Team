import{r as o,j as e,p as U,x as A,y as _,z as F,h as E,A as W,B as N,C as D,D as T,E as G}from"./index-DyprfCce.js";import{a as f}from"./api-Bbd7J0M8.js";function M(){const[h,c]=o.useState([]),[j,v]=o.useState([]),[g,k]=o.useState(""),[w,b]=o.useState(!1),[i,d]=o.useState({name:"",email:"",org_id:"",role:"student",password:""}),[p,S]=o.useState(null),[y,x]=o.useState(null);o.useEffect(()=>{C()},[]),o.useEffect(()=>{if(!g)v(h);else{const t=g.toLowerCase();v(h.filter(s=>s.name&&s.name.toLowerCase().includes(t)||s.email&&s.email.toLowerCase().includes(t)||s.org_id&&s.org_id.toLowerCase().includes(t)))}},[g,h]);async function C(){try{const t=await f.get("/admin/users");c(t.data.users||[])}catch(t){console.error(t)}}async function R(){if(!i.email)return alert("Email is required");try{if(p){const t=await f.put(`/admin/users/${p.id}`,{name:i.name,email:i.email,role:i.role,org_id:i.org_id});t.data.user&&c(s=>s.map(n=>n.id===p.id?t.data.user:n)),alert("User updated successfully")}else{const t={users:[{name:i.name,email:i.email,role:i.role}],org_id:i.org_id};await f.post("/admin/users/bulk-create",t),alert("User created successfully"),C()}u()}catch(t){alert("Failed to save user"),console.error(t)}}function B(t){S(t),d({name:t.name||"",email:t.email||"",org_id:t.org_id||"",role:t.role||"student",password:""}),b(!0)}function u(){b(!1),S(null),d({name:"",email:"",org_id:"",role:"student",password:""})}async function I(t,s){try{const n=await f.post(`/admin/users/${t}/activate`,{active:!s});n.data.user?c(a=>a.map(l=>l.id===t?n.data.user:l)):c(a=>a.map(l=>l.id===t?{...l,is_active:!s}:l))}catch(n){alert("Failed to update status"),console.error(n)}}async function z(t){var s,n;if(confirm("Are you sure you want to PERMANENTLY delete this user? This cannot be undone."))try{await f.delete(`/admin/users/${t}/hard-delete`),c(a=>a.filter(l=>l.id!==t))}catch(a){alert("Failed to delete user: "+(((n=(s=a.response)==null?void 0:s.data)==null?void 0:n.error)||a.message))}}return e.jsxs("div",{style:r.container,children:[e.jsxs("div",{style:m.header,children:[e.jsxs("div",{children:[e.jsxs("h1",{style:m.title,children:[e.jsx(U,{style:{marginRight:10}})," User Management"]}),e.jsx("p",{style:m.subtitle,children:"View, manage, and create platform users"})]}),e.jsxs("button",{style:m.primaryButton,onClick:()=>{u(),b(!w)},children:[e.jsx(A,{style:{marginRight:8}}),"Add User"]})]}),w&&e.jsxs("div",{style:r.formCard,children:[e.jsxs("div",{style:r.cardHeader,children:[e.jsx("h3",{style:r.formTitle,children:p?"Edit User":"Add New User"}),e.jsx("button",{onClick:u,style:r.closeBtn,children:e.jsx(_,{})})]}),e.jsxs("div",{style:r.formGrid,children:[e.jsxs("div",{style:r.inputGroup,children:[e.jsx("label",{style:r.label,children:"Name"}),e.jsx("input",{style:r.input,placeholder:"John Doe",value:i.name,onChange:t=>d({...i,name:t.target.value})})]}),e.jsxs("div",{style:r.inputGroup,children:[e.jsx("label",{style:r.label,children:"Email *"}),e.jsx("input",{style:r.input,placeholder:"john@example.com",value:i.email,onChange:t=>d({...i,email:t.target.value})})]}),e.jsxs("div",{style:r.inputGroup,children:[e.jsx("label",{style:r.label,children:"Organization ID"}),e.jsx("input",{style:r.input,placeholder:"Optional Org ID",value:i.org_id,onChange:t=>d({...i,org_id:t.target.value})})]}),e.jsxs("div",{style:r.inputGroup,children:[e.jsx("label",{style:r.label,children:"Role"}),e.jsxs("select",{style:r.select,value:i.role,onChange:t=>d({...i,role:t.target.value}),children:[e.jsx("option",{value:"student",children:"Student"}),e.jsx("option",{value:"admin",children:"Admin"})]})]})]}),e.jsxs("div",{style:r.formActions,children:[e.jsx("button",{style:r.cancelButton,onClick:u,children:"Cancel"}),e.jsx("button",{style:r.submitButton,onClick:R,children:p?"Update User":"Create User"})]})]}),e.jsxs("div",{style:r.toolbar,children:[e.jsxs("div",{style:r.searchBox,children:[e.jsx(F,{style:{color:"#94a3b8",marginRight:10}}),e.jsx("input",{style:r.searchInput,placeholder:"Search by name, email, or org...",value:g,onChange:t=>k(t.target.value)})]}),e.jsxs("div",{style:r.stats,children:["Total Users: ",e.jsx("strong",{children:h.length})]})]}),e.jsx("div",{style:r.tableCard,children:e.jsxs("table",{style:r.table,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:r.th,children:"User"}),e.jsx("th",{style:r.th,children:"Role"}),e.jsx("th",{style:r.th,children:"Organization"}),e.jsx("th",{style:r.th,children:"Status"}),e.jsx("th",{style:r.th,children:"Actions"})]})}),e.jsxs("tbody",{children:[j.map((t,s)=>e.jsxs("tr",{style:s%2!==0?r.trAlt:{},children:[e.jsx("td",{style:r.td,children:e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx("div",{style:r.avatar,children:e.jsx(E,{})}),e.jsxs("div",{children:[e.jsx("div",{style:r.userName,children:t.name||"No Name"}),e.jsx("div",{style:r.userEmail,children:t.email})]})]})}),e.jsx("td",{style:r.td,children:e.jsx("span",{style:t.role==="admin"?r.adminBadge:r.studentBadge,children:t.role})}),e.jsx("td",{style:r.td,children:t.org_id?e.jsxs("div",{children:[e.jsx("div",{style:r.orgName,children:t.org_name||"Unknown Org"}),e.jsx("code",{style:r.code,children:t.org_id})]}):e.jsx("span",{style:{color:"#cbd5e1"},children:"-"})}),e.jsx("td",{style:r.td,children:e.jsx("span",{style:t.is_active?r.statusActive:r.statusInactive,children:t.is_active?"Active":"Inactive"})}),e.jsx("td",{style:r.td,children:e.jsxs("div",{style:{position:"relative"},children:[e.jsx("button",{style:r.actionBtn,onClick:()=>x(y===t.id?null:t.id),children:e.jsx(W,{})}),y===t.id&&e.jsxs("div",{style:r.dropdownMenu,children:[e.jsxs("div",{style:r.dropdownItem,onClick:()=>{x(null),B(t)},children:[e.jsx(N,{style:{marginRight:8}})," Edit"]}),e.jsxs("div",{style:r.dropdownItem,onClick:()=>{x(null),I(t.id,t.is_active)},children:[t.is_active?e.jsx(D,{style:{marginRight:8,color:"#ef4444"}}):e.jsx(T,{style:{marginRight:8,color:"#16a34a"}}),t.is_active?"Deactivate":"Activate"]}),e.jsxs("div",{style:{...r.dropdownItem,color:"#ef4444"},onClick:()=>{x(null),z(t.id)},children:[e.jsx(G,{style:{marginRight:8}})," Delete"]})]}),y===t.id&&e.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",zIndex:998},onClick:()=>x(null)})]})})]},t.id)),j.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"5",style:r.empty,children:"No users found."})})]})]})})]})}const r={container:{padding:"32px",maxWidth:"1200px",margin:"0 auto",width:"100%",fontFamily:"'Inter', sans-serif"},formCard:{background:"#fff",borderRadius:"12px",padding:"24px",marginBottom:"32px",boxShadow:"0 4px 12px rgba(0,0,0,0.05)",border:"1px solid #e2e8f0"},formTitle:{fontSize:"16px",fontWeight:"600",marginBottom:"16px",color:"#334155"},formGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px",marginBottom:"24px"},inputGroup:{display:"flex",flexDirection:"column",gap:"6px"},label:{fontSize:"13px",fontWeight:"500",color:"#64748b"},input:{padding:"10px 12px",borderRadius:"6px",border:"1px solid #cbd5e1",fontSize:"14px",outline:"none"},select:{padding:"10px 12px",borderRadius:"6px",border:"1px solid #cbd5e1",fontSize:"14px",outline:"none",background:"#fff"},formActions:{display:"flex",justifyContent:"flex-end",gap:"12px"},cancelButton:{background:"transparent",border:"1px solid #cbd5e1",padding:"8px 16px",borderRadius:"6px",cursor:"pointer",color:"#64748b"},submitButton:{background:"#2563eb",color:"#fff",border:"none",padding:"8px 16px",borderRadius:"6px",cursor:"pointer",fontWeight:"500"},toolbar:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},searchBox:{display:"flex",alignItems:"center",background:"#fff",padding:"8px 16px",borderRadius:"8px",border:"1px solid #e2e8f0",width:"300px"},searchInput:{border:"none",outline:"none",width:"100%",fontSize:"14px",color:"#334155"},stats:{fontSize:"13px",color:"#64748b"},tableCard:{background:"#fff",borderRadius:"12px",boxShadow:"0 4px 6px rgba(0,0,0,0.02)",border:"1px solid #e2e8f0",overflow:"hidden"},table:{width:"100%",borderCollapse:"collapse",fontSize:"14px"},th:{textAlign:"left",padding:"16px",background:"#f8fafc",color:"#64748b",fontWeight:"600",borderBottom:"1px solid #e2e8f0"},td:{padding:"16px",borderBottom:"1px solid #e2e8f0",color:"#334155"},trAlt:{background:"#fcfcfc"},empty:{padding:"32px",textAlign:"center",color:"#94a3b8"},avatar:{width:"32px",height:"32px",borderRadius:"50%",background:"#e0e7ff",color:"#4338ca",display:"flex",alignItems:"center",justifyContent:"center",marginRight:"12px"},userName:{fontWeight:"600",color:"#1e293b"},userEmail:{fontSize:"12px",color:"#64748b"},code:{background:"#f1f5f9",padding:"2px 6px",borderRadius:"4px",fontFamily:"monospace",fontSize:"12px",color:"#475569"},orgName:{fontWeight:"600",fontSize:"13px",color:"#1e293b",marginBottom:"4px"},studentBadge:{background:"#f0f9ff",color:"#0369a1",padding:"2px 8px",borderRadius:"12px",fontSize:"12px",fontWeight:"500"},adminBadge:{background:"#fdf4ff",color:"#86198f",padding:"2px 8px",borderRadius:"12px",fontSize:"12px",fontWeight:"500"},statusActive:{display:"inline-flex",alignItems:"center",color:"#16a34a",fontWeight:"500",fontSize:"13px"},statusInactive:{display:"inline-flex",alignItems:"center",color:"#ef4444",fontWeight:"500",fontSize:"13px"},cardHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},actionBtn:{background:"transparent",border:"none",cursor:"pointer",padding:"8px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",color:"#64748b",transition:"background 0.2s",":hover":{background:"#f1f5f9"}},dropdownMenu:{position:"absolute",right:0,top:"100%",marginTop:"4px",background:"#fff",border:"1px solid #e2e8f0",borderRadius:"8px",boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)",zIndex:999,minWidth:"160px",overflow:"hidden"},dropdownItem:{padding:"10px 16px",fontSize:"14px",color:"#334155",cursor:"pointer",display:"flex",alignItems:"center",transition:"background 0.1s",":hover":{background:"#f8fafc"}},closeBtn:{background:"transparent",border:"none",cursor:"pointer",fontSize:"18px",color:"#94a3b8"}},m={header:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"32px",background:"#fff",padding:"24px 32px",borderRadius:"16px",boxShadow:"0 4px 20px rgba(0,0,0,0.05)",border:"1px solid #e2e8f0"},title:{fontSize:"24px",fontWeight:"700",color:"#0f172a",display:"flex",alignItems:"center",margin:0},subtitle:{fontSize:"14px",color:"#64748b",marginTop:"4px",margin:0},primaryButton:{background:"#2563eb",color:"#fff",border:"none",padding:"12px 24px",borderRadius:"10px",fontWeight:"600",cursor:"pointer",display:"flex",alignItems:"center",boxShadow:"0 4px 12px rgba(37,99,235,0.2)",transition:"all 0.2s",fontSize:"14px"}};export{M as default};
//# sourceMappingURL=AdminUsers-Cwh2emaa.js.map
